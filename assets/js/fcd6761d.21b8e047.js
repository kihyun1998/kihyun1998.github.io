"use strict";(self.webpackChunkblogsaurus=self.webpackChunkblogsaurus||[]).push([[35667],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>b});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var d=r.createContext({}),c=function(e){var n=r.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=c(e.components);return r.createElement(d.Provider,{value:n},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,d=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=c(t),u=o,b=m["".concat(d,".").concat(u)]||m[u]||p[u]||a;return t?r.createElement(b,i(i({ref:n},s),{},{components:t})):r.createElement(b,i({ref:n},s))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=u;var l={};for(var d in n)hasOwnProperty.call(n,d)&&(l[d]=n[d]);l.originalType=e,l[m]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},83593:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=t(87462),o=(t(67294),t(3905));const a={sidebar_position:8},i="[LLM] 8. Token Embedding",l={unversionedId:"llm/llm8",id:"llm/llm8",title:"[LLM] 8. Token Embedding",description:"---",source:"@site/docs/llm/llm8.md",sourceDirName:"llm",slug:"/llm/llm8",permalink:"/docs/llm/llm8",draft:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"aiSidebar",previous:{title:"[LLM] 7. \uc2ac\ub77c\uc774\ub529 \uc708\ub3c4\uc6b0",permalink:"/docs/llm/llm7"},next:{title:"[LLM] 9. Self Attention",permalink:"/docs/llm/llm9"}},d={},c=[{value:"\uc2e4\uc2b5",id:"\uc2e4\uc2b5",level:2},{value:"\uc784\ubca0\ub529 \uac12 \ud655\uc778",id:"\uc784\ubca0\ub529-\uac12-\ud655\uc778",level:3},{value:"\uc784\ubca0\ub529 \uac12 \uc2dc\uac01\ud654",id:"\uc784\ubca0\ub529-\uac12-\uc2dc\uac01\ud654",level:3}],s={toc:c},m="wrapper";function p(e){let{components:n,...a}=e;return(0,o.kt)(m,(0,r.Z)({},s,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"llm-8-token-embedding"},"[LLM]"," 8. Token Embedding"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"LLM\uc740 Text\ub97c \uc22b\uc790\ub85c \ubcc0\ud658\ud574\uc918\uc57c \ud559\uc2b5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ub54c \ub2e8\uc21c\ud788 \ub2e8\uc5b4\ub9c8\ub2e4 ID\ub97c \ubd80\uc5ec\ud558\uba74 \ucc28\uc6d0\uc774 \ub108\ubb34 \ucee4\uc9d1\ub2c8\ub2e4. \uadf8\ub798\uc11c Embedding\uc744 \uc774\uc6a9\ud558\uc5ec \ucc28\uc6d0\uc744 \ucd95\uc18c\ud558\uace0 \uc758\ubbf8\ub97c \ubcf4\uc874\ud558\uc5ec \ud6a8\uc728\uc801\uc778 \ud559\uc2b5\uc744 \ucd94\uad6c\ud569\ub2c8\ub2e4."),(0,o.kt)("h2",{id:"\uc2e4\uc2b5"},"\uc2e4\uc2b5"),(0,o.kt)("h3",{id:"\uc784\ubca0\ub529-\uac12-\ud655\uc778"},"\uc784\ubca0\ub529 \uac12 \ud655\uc778"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'import torch \nimport torch.nn as nn \n\nword_to_index = {"cat": 0, "dog": 1, "mat": 2, "sat": 3} \nvocab_size = len(word_to_index)\nembedding_dim = 3\n\nembedding_layer = nn.Embedding(vocab_size, embedding_dim) \n\n# \uac01 \ub2e8\uc5b4\ubcc4\ub85c \uc784\ubca0\ub529 \ubca1\ud130 \ud655\uc778\nfor word in ["cat", "dog", "mat", "sat"]:\n    index = torch.tensor([word_to_index[word]])\n    vector = embedding_layer(index)\n    print(f"{word}\uc758 \uc784\ubca0\ub529 \ubca1\ud130: {vector.squeeze()}")\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"cat\uc758 \uc784\ubca0\ub529 \ubca1\ud130: tensor([-0.1789, -1.1320,  0.7210], grad_fn=<SqueezeBackward0>)\ndog\uc758 \uc784\ubca0\ub529 \ubca1\ud130: tensor([0.4850, 0.2686, 1.2284], grad_fn=<SqueezeBackward0>)\nmat\uc758 \uc784\ubca0\ub529 \ubca1\ud130: tensor([ 1.5514,  0.1519, -0.7032], grad_fn=<SqueezeBackward0>)\nsat\uc758 \uc784\ubca0\ub529 \ubca1\ud130: tensor([ 0.0770, -1.4069,  0.6025], grad_fn=<SqueezeBackward0>)\n")),(0,o.kt)("h3",{id:"\uc784\ubca0\ub529-\uac12-\uc2dc\uac01\ud654"},"\uc784\ubca0\ub529 \uac12 \uc2dc\uac01\ud654"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'import torch \nimport torch.nn as nn \nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D  # 3D \ud50c\ub85c\ud305\uc744 \uc704\ud574 \ud544\uc694\n\nword_to_index = {"cat": 0, "dog": 1, "mat": 2, "sat": 3} \nvocab_size = len(word_to_index)\nembedding_dim = 3\n\nembedding_layer = nn.Embedding(vocab_size, embedding_dim) \n\nwords = ["cat", "dog", "mat", "sat"]\nword_inputs = torch.tensor([word_to_index[word] for word in words])\nembedding_vectors = embedding_layer(word_inputs)\n\n# 3D \uadf8\ub798\ud504 \uc0dd\uc131\nfig = plt.figure(figsize=(10, 10))\nax = fig.add_subplot(111, projection=\'3d\')\n\n# \ubca1\ud130\uac12 \ucd94\ucd9c\nvectors = embedding_vectors.detach().numpy()\n\n# \uac01 \ub2e8\uc5b4\ub97c 3D \uacf5\uac04\uc5d0 \ud50c\ub85c\ud305\nfor i, word in enumerate(words):\n    ax.scatter(vectors[i, 0], vectors[i, 1], vectors[i, 2])\n    ax.text(vectors[i, 0], vectors[i, 1], vectors[i, 2], word)\n\nax.set_xlabel(\'Dimension 1\')\nax.set_ylabel(\'Dimension 2\')\nax.set_zlabel(\'Dimension 3\')\nplt.title(\'Word Embeddings in 3D Space\')\n\nplt.show()\n')),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"alt text",src:t(8478).Z,width:"1000",height:"1000"})),(0,o.kt)("p",null,"\ud559\uc2b5\uc774 \ub41c \uacb0\uacfc\ub294 \uc544\ub2c8\uc9c0\ub9cc \uadf8\ub0e5 \uc774\ub7f0\uc2dd\uc73c\ub85c \uc784\ubca0\ub529\uc774 \ub418\ub294\uad6c\ub098\ub97c \uc54c \uc218 \uc788\uc5c8\uc2b5\ub2c8\ub2e4."),(0,o.kt)("p",null,"3\ucc28\uc6d0\uae4c\uc9c0\ub9cc \ud655\uc778\ud588\ub294\ub370 \ub2e4\ucc28\uc6d0\uc774\ub77c\uace0 \uac00\uc815\ud558\uace0 \uc0c1\uc0c1\uc740 \ud574\ubcfc \uc218 \uc788\uc744 \uac83 \uac19\uc2b5\ub2c8\ub2e4."))}p.isMDXComponent=!0},8478:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/Figure_1-60858792b75a3f4e5c7ee6b0bb0642c5.png"}}]);