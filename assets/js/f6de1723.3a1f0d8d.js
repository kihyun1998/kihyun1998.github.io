"use strict";(self.webpackChunkblogsaurus=self.webpackChunkblogsaurus||[]).push([[4575],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),k=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=k(e.components);return a.createElement(p.Provider,{value:n},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=k(t),d=r,m=u["".concat(p,".").concat(d)]||u[d]||c[d]||l;return t?a.createElement(m,o(o({ref:n},s),{},{components:t})):a.createElement(m,o({ref:n},s))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=d;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[u]="string"==typeof e?e:r,o[1]=i;for(var k=2;k<l;k++)o[k]=t[k];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},72406:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>k});var a=t(87462),r=(t(67294),t(3905));const l={sidebar_position:1},o="[React + Spring + Kube] KOSTA 1",i={unversionedId:"react-spring-kube/react-spring-kube1",id:"react-spring-kube/react-spring-kube1",title:"[React + Spring + Kube] KOSTA 1",description:"---",source:"@site/docs/react-spring-kube/react-spring-kube1.md",sourceDirName:"react-spring-kube",slug:"/react-spring-kube/react-spring-kube1",permalink:"/docs/react-spring-kube/react-spring-kube1",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"studySidebar",previous:{title:"[Docker & Kubernetes] KOSTA 3",permalink:"/docs/docker-kube/docker-kube3"}},p={},k=[{value:"git \uc124\uc815",id:"git-\uc124\uc815",level:2},{value:"\uc2a4\ud504\ub9c1 \uc2dc\uc791",id:"\uc2a4\ud504\ub9c1-\uc2dc\uc791",level:2},{value:"\ub3c4\uba54\uc778",id:"\ub3c4\uba54\uc778",level:2},{value:"\uc5d4\ud2f0\ud2f0",id:"\uc5d4\ud2f0\ud2f0",level:3},{value:"repository",id:"repository",level:3},{value:"Service",id:"service",level:3},{value:"\uc5b4\ub178\ud14c\uc774\uc158",id:"\uc5b4\ub178\ud14c\uc774\uc158",level:4},{value:"\uc758\uc874\uc131 \uc8fc\uc785 DI",id:"\uc758\uc874\uc131-\uc8fc\uc785-di",level:4},{value:"controller",id:"controller",level:3},{value:"runner",id:"runner",level:3},{value:"\ud398\uc774\uc9d5",id:"\ud398\uc774\uc9d5",level:2},{value:"dto",id:"dto",level:2},{value:"flyway",id:"flyway",level:2},{value:"\uc0ac\uc6a9",id:"\uc0ac\uc6a9",level:3},{value:"postgresql",id:"postgresql",level:2},{value:"postgresql \uc2e4\ud589",id:"postgresql-\uc2e4\ud589",level:2},{value:"db \uc811\uc18d",id:"db-\uc811\uc18d",level:3},{value:"\uc720\uc800 \uc0dd\uc131",id:"\uc720\uc800-\uc0dd\uc131",level:3},{value:"db \uc0dd\uc131",id:"db-\uc0dd\uc131",level:3},{value:"\uc5f0\uacb0",id:"\uc5f0\uacb0",level:3},{value:"\ud14c\uc774\ube14 \uc870\ud68c",id:"\ud14c\uc774\ube14-\uc870\ud68c",level:3},{value:"dto projection",id:"dto-projection",level:2},{value:"mapper \uc0ac\uc6a9",id:"mapper-\uc0ac\uc6a9",level:3},{value:"sql \uc0ac\uc6a9",id:"sql-\uc0ac\uc6a9",level:3},{value:"test containers",id:"test-containers",level:2},{value:"Search \uae30\ub2a5 \uad6c\ud604",id:"search-\uae30\ub2a5-\uad6c\ud604",level:2},{value:"JPQL",id:"jpql",level:3},{value:"JPA Query Method",id:"jpa-query-method",level:3},{value:"Interface projection",id:"interface-projection",level:3},{value:"JPA",id:"jpa",level:2},{value:"create",id:"create",level:2},{value:"\uc785\ub825 \ud56d\ubaa9 \uac80\uc99d",id:"\uc785\ub825-\ud56d\ubaa9-\uac80\uc99d",level:3},{value:"cors",id:"cors",level:2},{value:"docker \ubc30\ud3ec",id:"docker-\ubc30\ud3ec",level:2},{value:"jar \uc0dd\uc131",id:"jar-\uc0dd\uc131",level:3},{value:"docker \uc774\ubbf8\uc9c0 \uc0dd\uc131",id:"docker-\uc774\ubbf8\uc9c0-\uc0dd\uc131",level:3},{value:"github action \uc124\uc815",id:"github-action-\uc124\uc815",level:2}],s={toc:k},u="wrapper";function c(e){let{components:n,...t}=e;return(0,r.kt)(u,(0,a.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"react--spring--kube-kosta-1"},"[React + Spring + Kube]"," KOSTA 1"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"\uccab\uc9f8 \ub0a0\uc5d0\ub294 \ubc31\uc5d4\ub4dc \uadf8\ub2e4\uc74c\uc5d0\ub294 Next.js\ub85c \ud504\ub860\ud2b8\ub97c \uadf8\ub2e4\uc74c\uc5d0\ub294 \ucfe0\ubcb5\ub124 \ubc30\ud3ec\ud558\ub294 \uacfc\uc815\uc774\ub2e4."),(0,r.kt)("h2",{id:"git-\uc124\uc815"},"git \uc124\uc815"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git remote set-url origin https://ACCESS_TOKEN@\uc800\uc7a5\uc18cURL.git\n")),(0,r.kt)("h2",{id:"\uc2a4\ud504\ub9c1-\uc2dc\uc791"},"\uc2a4\ud504\ub9c1 \uc2dc\uc791"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"BookMarker\ub77c\ub294 API \ubc31\uc5d4\ub4dc\ub97c \uc2dc\uc791\ud55c\ub2e4."),(0,r.kt)("p",null,"\ud504\ub85c\uc81d\ud2b8 \uc2a4\ud399\uc740 \ub2e4\uc74c\uacfc \uac19\ub2e4."),(0,r.kt)("p",null,"Project : ",(0,r.kt)("inlineCode",{parentName:"p"},"Maven"),(0,r.kt)("br",{parentName:"p"}),"\n","Language: ",(0,r.kt)("inlineCode",{parentName:"p"},"Java 17"),"\nDependencies: ",(0,r.kt)("inlineCode",{parentName:"p"},"Spring Web"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Spring Data JPA"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Lombok"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Dev Tools"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Configuration Prociessor"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Testcontainers"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Flyway Migration"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"H2 Database"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"PostreSQL"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Validation"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Actuator")),(0,r.kt)("h2",{id:"\ub3c4\uba54\uc778"},"\ub3c4\uba54\uc778"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"\uc5d4\ud2f0\ud2f0"},"\uc5d4\ud2f0\ud2f0"),(0,r.kt)("p",null,"\uc5b4\ub178\ud14c\uc774\uc158\uc744 \uc0ac\uc6a9\ud574\uc11c \uc5d4\ud2f0\ud2f0\ub97c \uc815\uc758\ud558\uace0 \ud14c\uc774\ube14\uc744 \uc815\uc758\ud588\ub2e4."),(0,r.kt)("p",null,"id \uac12\uc740 SequenceGenerator\ub97c \uc0ac\uc6a9\ud588\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"localhost:8080/h2-console"},"localhost:8080/h2-console")," \ub85c \ub4e4\uc5b4\uac00\uba74 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucf58\uc194\uc5d0 \ub4e4\uc5b4\uac08 \uc218 \uc788\ub2e4."),(0,r.kt)("h3",{id:"repository"},"repository"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"crud \ub808\ud3ec\uc9c0\ud1a0\ub9ac\uc640 paging \ub808\ud3ec\uc9c0\ud1a0\ub9ac\uac00 \ubd84\ub9ac\ub410\ub294\ub370 JPARepository\ub85c \uc0ac\uc6a9\ud574\uc11c \ub458\ub2e4 \uc0ac\uc6a9\ud560 \uc218 \ub3c4 \uc788\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-data/jpa/reference/jpa/query-methods.html"},"\uc5ec\uae30"),"\uc5d0\uc11c JPA \ubb38\uc11c\ub97c \ubcfc \uc218 \uc788\ub294\ub370"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public interface UserRepository extends JpaRepository<User, Long> {\n\n  @Query("select u from User u where u.emailAddress = ?1")\n  User findByEmailAddress(String emailAddress);\n}\n')),(0,r.kt)("p",null,"\uc774\ub7f0\uc2dd\uc73c\ub85c \ucffc\ub9ac\uc791\uc131\ub3c4 \ud560 \uc218 \uc788\ub2e4\uace0 \ud55c\ub2e4."),(0,r.kt)("h3",{id:"service"},"Service"),(0,r.kt)("hr",null),(0,r.kt)("h4",{id:"\uc5b4\ub178\ud14c\uc774\uc158"},"\uc5b4\ub178\ud14c\uc774\uc158"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"@Transactional"),"\uc744 \uc0ac\uc6a9\ud55c\ub2e4. \uc774 \uc5b4\ub178\ud14c\uc774\uc158 \uc120\uc5b8\ud558\uba74 \uc790\ub3d9\uc73c\ub85c \uc27d\uac8c \ud2b8\ub79c\uc7ad\uc158 \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ud574\uc90c."),(0,r.kt)("h4",{id:"\uc758\uc874\uc131-\uc8fc\uc785-di"},"\uc758\uc874\uc131 \uc8fc\uc785 DI"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Setter Injection")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\uc778\uc2a4\ud134\uc2a4 \ubcc0\uc218 \uc704\uc5d0 ",(0,r.kt)("inlineCode",{parentName:"li"},"@Autowired"),",",(0,r.kt)("inlineCode",{parentName:"li"},"@Resource")," \uc120\uc5b8",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@Autowired")," : type base \uac1d\uccb4 \ucc3e\uc544\uc11c \uc8fc\uc785"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@Resource")," : Beand id\ub85c \uac1d\uccb4 \ucc3e\uc544\uc11c \uc8fc\uc785"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Constructor Injection")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\uc0dd\uc131\uc790 \uc8fc\uc785",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Mock\uc744 \ub9cc\ub4e4 \ub54c \ud560 \uc218 \uc788\uc74c. Lombok\uc758 RequiredArgsConstructor \uc5b4\ub178\ud14c\uc774\uc158 \uc0ac\uc6a9")))))),(0,r.kt)("h3",{id:"controller"},"controller"),(0,r.kt)("p",null,"\uadf8\ub0e5 \uc0dd\uc131\ud588\uc2b5\ub2c8\ub2e4."),(0,r.kt)("h3",{id:"runner"},"runner"),(0,r.kt)("p",null,"runner\ub77c\ub294\uac8c \uc788\uc74c."),(0,r.kt)("p",null,"CommandLineRunner\ub97c implements\ud574\uc11c \uc0ac\uc6a9\ud558\ub294\ub370"),(0,r.kt)("p",null,"Database\uc5d0 \uac12\uc744 insert \ud558\uae30 \uc704\ud574\uc11c \uc0ac\uc6a9\ud558\uae30\ub3c4 \ud568."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"@Order(\uc22b\uc790)")," \uc5b4\ub178\ud14c\uc774\uc158\uc73c\ub85c \uc6b0\uc120\uc21c\uc704 \uc815\ud560 \uc218 \uc788\uc74c."),(0,r.kt)("p",null,"profile\uc774 ",(0,r.kt)("inlineCode",{parentName:"p"},"test"),"\uc778 \uacbd\uc6b0\uc5d0 ",(0,r.kt)("inlineCode",{parentName:"p"},'@Profile("dev")')," \uc774\ub7f0\uc2dd\uc73c\ub85c \ud558\uba74 runner\uac00 \uc2e4\ud589\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. "),(0,r.kt)("p",null,"\uc774\ub7f0\uc2dd\uc73c\ub85c \uad6c\ubd84\ud560 \uc218 \uc788\ub2e4."),(0,r.kt)("h2",{id:"\ud398\uc774\uc9d5"},"\ud398\uc774\uc9d5"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Controller\uc640 Service\ub97c \uc218\uc815\ud574\uc11c \ud398\uc774\uc9d5 \ud560 \uc218 \uc788\ub2e4."),(0,r.kt)("p",null,"PageRequest\ub97c \uc0ac\uc6a9\ud574\uc11c \uc9c4\ud589\ud558\uba74 \ub41c\ub2e4."),(0,r.kt)("h2",{id:"dto"},"dto"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"dto\ub97c \uc801\uc6a9\ud558\ub294 \uc774\uc720\ub294 SRP \ub54c\ubb38\uc774\ub2e4."),(0,r.kt)("p",null,"entity\ub97c \uadf8\ub300\ub85c \uc0ac\uc6a9\ud558\uba74 entity\ub97c \uc218\uc815\ud558\uace0 \uc554\ud2bc \ubc88\uac70\ub85c\uc6cc\uc9c0\uae30 \ub54c\ubb38."),(0,r.kt)("h2",{id:"flyway"},"flyway"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"db \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud234\uc774\ub2e4."),(0,r.kt)("p",null,"db\uac00 \ube44\uc6cc\uc838\uc788\uc73c\uba74 schema history table \uc0dd\uc131\ud558\uace0 \uc0c1\ud0dc\ub97c \ucd94\uc801\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"resources/db/migration")," \ud30c\uc77c\ub4e4\uc744 \uc2a4\uce94\ud55c\ub2e4."),(0,r.kt)("p",null,"prefix, version, separator, description, suffix\ub85c \uad6c\uc131\ub41c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"prfix"),"\uc5d0\uc11c V\ub294 \ubc84\uc804 \ub9c8\uc774\uadf8\ub808\uc774\uc158 R\uc740 \ubc18\ubcf5, U\ub294 \ucde8\uc18c \ub9c8\uc774\uadf8\ub808\uc774\uc158,"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"version"),"\uc740 \uc22b\uc790, \uc810 \uc5b8\ub354\ubc14 \uc870\ud569 ex- V2.1"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"description"),"\uc740 \uc124\uba85 \uce7c\ub7fc\uc5d0 \ucd94\uac00"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"suffix")," \ud655\uc7a5\uc790\uc778\ub370 \uae30\ubcf8\uc740 .sql"),(0,r.kt)("h3",{id:"\uc0ac\uc6a9"},"\uc0ac\uc6a9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"spring.flyway.locations=classpath:/db/migration/{vendor}\n# sql \uae30\ub85d\nspring.flyway.baselineOnMigrate=true\n# flyway\ub85c \ud615\uc0c1 \uad00\ub9ac\nspring.flyway.enabled=true\n")),(0,r.kt)("p",null,"application.properties\uc5d0\uc11c \uc774\ub7f0\uc2dd\uc73c\ub85c \uc124\uc815\ud574\uc11c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4\uace0 \ud569\ub2c8\ub2e4."),(0,r.kt)("p",null,"FlywayAutoConfiguration \ud074\ub798\uc2a4\uac00 \uc788\uc5b4\uc11c vendor\ub97c \ucd94\uc801\ud55c\ub2e4\uace0 \ud568."),(0,r.kt)("p",null,"\uadf8\ub2c8\uae4c ",(0,r.kt)("inlineCode",{parentName:"p"},"spring.flyway.location")," \uac12\uc5d0 \uc788\ub294 /db/migration/{vendor} \uc774\ub807\uac8c \ub3fc\uc788\ub294\ub370 "),(0,r.kt)("p",null,"\uc2e4\uc81c \uacbd\ub85c\uc5d0\uc11c \uc800\uae30\uc5d0 vendor \uc790\ub9ac\uc5d0 h2\uac00 \uc788\uc73c\uba74 h2\ub85c \ub9cc\ub4e4\uc5b4\uc9c4\ub2e4 \uc774\uac70\uc784."),(0,r.kt)("h2",{id:"postgresql"},"postgresql"),(0,r.kt)("p",null,"docker hub\uc5d0\uc11c postgres docker\ub97c \uac00\uc838\uc640\uc57c\ud55c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull postgres:\ud0dc\uadf8\uba85\n")),(0,r.kt)("p",null,"\uadf8\ub9ac\uace0 \uc544\ub798\ucc98\ub7fc \uc2e4\ud589\ud560 \uc218 \uc788\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --name PostgreSQL -e POSTGRES_USER=\uc720\uc800\uba85 -e POSTGRES_PASSWORD=\ube44\ubc00\ubc88\ud638 -d -p 5432:5432 postgres:\ud0dc\uadf8\uba85\n")),(0,r.kt)("h2",{id:"postgresql-\uc2e4\ud589"},"postgresql \uc2e4\ud589"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -it PostgreSQL bin/bash\n")),(0,r.kt)("p",null,"\uc774\ub7ec\uba74 postgreSQL \ub4e4\uc5b4\uac08 \uc218 \uc788\uace0"),(0,r.kt)("p",null,"\uadf8 \uc548\uc5d0\uc11c\ub3c4 "),(0,r.kt)("h3",{id:"db-\uc811\uc18d"},"db \uc811\uc18d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"psql -U postgres -W\n")),(0,r.kt)("p",null,"\uc774\ub807\uac8c \ud574\uc57c \uc5f0\uacb0\uc774 \ub41c\ub2e4."),(0,r.kt)("h3",{id:"\uc720\uc800-\uc0dd\uc131"},"\uc720\uc800 \uc0dd\uc131"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE USER bookmark PASSWORD 'bookmark' SUPERUSER;\n")),(0,r.kt)("p",null,"\uc774\ub807\uac8c \uc720\uc800 \uc0dd\uc131\ub3c4 \ud560 \uc218 \uc788\uace0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\\du\n")),(0,r.kt)("p",null,"\uc720\uc800 \ub9ac\uc2a4\ud2b8 \ud655\uc778 \uac00\ub2a5\ud558\ub2e4."),(0,r.kt)("h3",{id:"db-\uc0dd\uc131"},"db \uc0dd\uc131"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE DATABASE bookmarkdb OWNER bookmark;\n")),(0,r.kt)("p",null,"\ud655\uc778 "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\\l\n")),(0,r.kt)("h3",{id:"\uc5f0\uacb0"},"\uc5f0\uacb0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\\c bookmarkdb bookmark\n")),(0,r.kt)("h3",{id:"\ud14c\uc774\ube14-\uc870\ud68c"},"\ud14c\uc774\ube14 \uc870\ud68c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\\dt\n")),(0,r.kt)("p",null,"\ucc98\uc74c\uc5d0 \ud558\uba74 \uc548\ub418\uace0 \uc124\uc815\uc744 \ub9c8\uce58\uace0 \ud30c\uc77c \uc791\uc131\ud558\uba74 \ub420 \uac83\uc774\ub2e4."),(0,r.kt)("h2",{id:"dto-projection"},"dto projection"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"mapper-\uc0ac\uc6a9"},"mapper \uc0ac\uc6a9"),(0,r.kt)("p",null,"mapper\uc640 bookmarkDTO\ub97c \uad6c\ud604\ud558\uc5ec\uc11c map \ud568\uc218\ub97c \uc0ac\uc6a9\ud574\uc11c \uac00\uc838\uc624\ub294 \ubc29\ubc95\ub3c4 \uc788\ub2e4.."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Setter\n@Getter\n@AllArgsConstructor\npublic class BookmarkDTO {\n    private Long id;\n    private String title;\n    private String url;\n    private Instant createdAt;\n}\n\n@Component\npublic class BookmarkMapper {\n\n    public BookmarkDTO toDTO(Bookmark bookmark) {\n        return new BookmarkDTO(\n            bookmark.getId(),\n            bookmark.getTitle(),\n            bookmark.getUrl(),\n            bookmark.getCreatedAt()\n        );\n    }\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public class BookmarkService {\n    private final BookmarkRepository repository;\n    private final BookmarkMapper mapper;\n\n    @Transactional(readOnly = true)\n      public BookmarksDTO getBookmarks(Integer page) {\n        int pageNo = page < 1 ? 0 : page - 1;\n        Pageable pageable = PageRequest.of(pageNo, 10, Sort.Direction.DESC, "id");\n        \n        // \uc5ec\uae30\uc11c map \uc0ac\uc6a9\ud574\uc11c \uc801\uc6a9\n        Page<BookmarkDTO> bookmarkPage = repository.findAll(pageable)\n                //.map(bookmark -> mapper.toDTO(bookmark));\n                .map(mapper::toDTO);\n        return new BookmarksDTO(bookmarkPage);\n    }\n}\n')),(0,r.kt)("h3",{id:"sql-\uc0ac\uc6a9"},"sql \uc0ac\uc6a9"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://medium.com/javarevisited/mastering-projections-in-spring-data-jpa-a-comprehensive-introduction-7bc2e64e4c14"},"\ucc38\uace0\ubb38\uc11c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public interface BookmarkRepository extends JpaRepository<Bookmark, Long> {\n    @Query("""\n    select new com.bookmarker.api.dto.BookmarkDTO(b.id, b.title, b.url, b.createdAt) from Bookmark b\n    """)\n    Page<BookmarkDTO> findBookmarks(Pageable pageable);\n}\n')),(0,r.kt)("p",null,"\uc774\ub807\uac8c repository\uc5d0 find \uba54\uc11c\ub4dc\ub97c \uc120\uc5b8\ud558\uace0 "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},' @Transactional(readOnly = true)\n    public BookmarksDTO getBookmarks(Integer page) {\n        int pageNo = page < 1 ? 0 : page - 1;\n        Pageable pageable = PageRequest.of(pageNo, 10, Sort.Direction.DESC, "id");\n        Page<BookmarkDTO> bookmarkPage = repository.findBookmarks(pageable);\n        return new BookmarksDTO(bookmarkPage);\n    }\n')),(0,r.kt)("p",null,"\uc774\ub807\uac8c \uc0ac\uc6a9\ud558\uba74 \ub41c\ub2e4."),(0,r.kt)("h2",{id:"test-containers"},"test containers"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"\ud1b5\ud569 \ud14c\uc2a4\ud2b8\ub97c \ud558\ub294 \uc5ec\ub7ec \ubc29\ubc95\uc774 \uc788\ub2e4."),(0,r.kt)("p",null,"local\uc5d0\uc11c \uc62c\ub824\uc11c test \ud558\ub358\uac00 in-memory\ub85c \ud558\ub358\uac00 embeded library\ub3c4 \uc788\uc9c0\ub9cc"),(0,r.kt)("p",null,"test container\ub97c \ud65c\uc6a9\ud558\ub294 \uac83\uc774 \ucd94\ucc9c \ub41c\ub2e4."),(0,r.kt)("h2",{id:"search-\uae30\ub2a5-\uad6c\ud604"},"Search \uae30\ub2a5 \uad6c\ud604"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"jpql"},"JPQL"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},' @Query("""\n    select new com.bookmarker.api.dto.BookmarkDTO(b.id, b.title, b.url, b.createdAt) from Bookmark b\n    where lower(b.title) like lower(concat(\'%\', :query, \'%\'))\n    """)\n    Page<BookmarkDTO> searchBookmarks(String query, PageRequest pageRequest);\n')),(0,r.kt)("p",null,"\uc774\ub807\uac8c jpql\uc744 \uc0ac\uc6a9\ud574\ub3c4 \ub418\uace0"),(0,r.kt)("h3",{id:"jpa-query-method"},"JPA Query Method"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-data/jpa/reference/jpa/query-methods.html"},"JPA Query Methods")," \uc774 \uacf3\uc5d0\uc11c findBy \uba54\uc11c\ub4dc\ub97c \uad6c\uacbd\ud560 \uc218 \uc788\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"Page<BookmarkDTO> findByTitleContainsIgnoreCase(String query, PageRequest pageRequest);\n")),(0,r.kt)("p",null,"\uc774\ub807\uac8c findBy method\ub97c \uc0ac\uc6a9\ud574\ub3c4 \ub41c\ub2e4."),(0,r.kt)("h3",{id:"interface-projection"},"Interface projection"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-data/jpa/reference/repositories/projections.html"},"Projections")),(0,r.kt)("h2",{id:"jpa"},"JPA"),(0,r.kt)("hr",null),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"jakarta.persistence")," = ",(0,r.kt)("inlineCode",{parentName:"p"},"JPA")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"jakarta.validation")," = ",(0,r.kt)("inlineCode",{parentName:"p"},"Java Bean")),(0,r.kt)("p",null,"\uc774\ub7f0\uac74\uac00?"),(0,r.kt)("h2",{id:"create"},"create"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"\uc785\ub825-\ud56d\ubaa9-\uac80\uc99d"},"\uc785\ub825 \ud56d\ubaa9 \uac80\uc99d"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"problem-spring-web"),"\uc774\ub77c\ub294 \uc758\uc874\uc131 \ucd94\uac00\ud558\uba74 \uc624\ub958 \uba54\uc2dc\uc9c0 \uad1c\ucc2e\uac8c \ub098\uc628\ub2e4."),(0,r.kt)("h2",{id:"cors"},"cors"),(0,r.kt)("hr",null),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class WebConfig {\n    @Bean\n    public FilterRegistrationBean<?> corsConfigurationSource() {\n        /// cors configuration \uac00\uc838\uc634\n        CorsConfiguration configuration = new CorsConfiguration();\n\n        /// \uc624\ub9ac\uc9c4 \ubaa8\ub450 \ud5c8\uc6a9\n        configuration.setAllowedOrigins(Arrays.asList("*"));\n        \n        /// \ud06c\ub9ac\ub374\uc15c true\n        configuration.setAllowCredentials(true);\n        \n        /// \ud5e4\ub354 \ud5c8\uc6a9\n        configuration.setAllowedHeaders(Arrays.asList(\n                "Access-Control-Allow-Headers",\n                "Access-Control-Allow-Origin",\n                "Access-Control-Request-Method",\n                "Access-Control-Request-Headers",\n                "Origin",\n                "Cache-Control",\n                "Content-Type", \n                "Authorization"));\n        \n        /// \uba54\uc11c\ub4dc \ud5c8\uc6a9\n        configuration.setAllowedMethods(Arrays.asList("POST", "DELETE", "GET", "PATCH", "PUT"));\n\n        /// UrlBasedCorsConfigurationSource \ud074\ub798\uc2a4\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        \n        /// configuration \uac12\uc744 \uc801\uc6a9\n        source.registerCorsConfiguration("/**", configuration);\n\n        /// CorsFilter\uc5d0 \uc774 \uc124\uc815\uac12\uc744 \uc801\uc6a9\n        FilterRegistrationBean<?> bean = new FilterRegistrationBean<>(new CorsFilter(source));\n        bean.setOrder(0);\n        return bean;\n    }\n}\n')),(0,r.kt)("p",null,"\uc774\ub7f0\uc2dd\uc73c\ub85c webConfig \uc0dd\uc131\ud574\uc11c bean\uc5d0 \ub4f1\ub85d\ud558\uc5ec \uc0ac\uc6a9"),(0,r.kt)("h2",{id:"docker-\ubc30\ud3ec"},"docker \ubc30\ud3ec"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"jar-\uc0dd\uc131"},"jar \uc0dd\uc131"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\ud30c\uc77c \uc774\ub984 \uc124\uc815",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"build")," \ud0dc\uadf8 \uc548\uc5d0 ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins")," \ud0dc\uadf8 \ubc11\uc5d0 ",(0,r.kt)("inlineCode",{parentName:"p"},"finalName"),"\uc73c\ub85c \uc124\uc815\ud55c\ub2e4."),(0,r.kt)("p",{parentName:"li"},"\uadf8\ub9ac\uace0 maven\uc774\ub098 gradel \uc5c5\ub370\uc774\ud2b8")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\ube4c\ub4dc"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"maven"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvnw clean package\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvnw clean package -Dmaven.test.skip=true\n")),(0,r.kt)("p",null,"\uc704\ucc98\ub7fc \ud558\uba74 \ud14c\uc2a4\ud2b8 \uc2a4\ud0b5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvnw clean package -Dspring.profiles.active=dev\n")),(0,r.kt)("p",null,"\uc704\ucc98\ub7fc \ud558\uba74 \ud504\ub85c\ud30c\uc77c \uc9c0\uc815"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvnw clean package -Denv=production\n")),(0,r.kt)("p",null,"\uc774\ub807\uac8c \ud558\uba74 \ubcc0\uc218 \uc9c0\uc815"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"gradle"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"gradlew.bat clean bootJar\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\uc2e4\ud589")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"java -jar target\\springboot-nextjs-backend.jar --spring.profiles.active=prod\n")),(0,r.kt)("p",null,"\uc774\ub7f0\uc2dd\uc73c\ub85c \ud560 \uc218 \uc788\ub2e4."),(0,r.kt)("p",null,"target.. \uc774\uac70\ub294 \uc2e4\ud589\ud560 jar\ud30c\uc77c\uc774\uace0 profiles.active \uc124\uc815\uc740 profile \uac12\uc744 \ubb50\ub85c\ud560\uc9c0 \uc815\ud558\ub294\uac70\ub2e4."),(0,r.kt)("h3",{id:"docker-\uc774\ubbf8\uc9c0-\uc0dd\uc131"},"docker \uc774\ubbf8\uc9c0 \uc0dd\uc131"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\ub3c4\ucee4\ud30c\uc77c \uc0dd\uc131"))),(0,r.kt)("p",null,"\uba3c\uc800 \ub3c4\ucee4\ud30c\uc77c \uc0dd\uc131\ud558\uace0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-dockerfile"},'FROM openjdk:20\nVOLUME /tmp\nCOPY target/springboot-nextjs-backend.jar springboot-nextjs-backend.jar\nENTRYPOINT ["java","-jar","/springboot-nextjs-backend.jar","--spring.profiles.active=prod"]\n')),(0,r.kt)("p",null,"\uc704\ucc98\ub7fc \uc791\uc131\ud558\uba74 \ub429\ub2c8\ub2e4."),(0,r.kt)("p",null,"\uc774\ubbf8\uc9c0\ub294 openjdk\ub97c \uc0ac\uc6a9\ud558\uace0"),(0,r.kt)("p",null,"jar \ud30c\uc77c\uc744 \ubcf5\uc0ac\ud574\uc11c"),(0,r.kt)("p",null,"entry point \uba85\ub839\uc5b4\ub4e4\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\ub3c4\ucee4 \uc774\ubbf8\uc9c0 \ube4c\ub4dc"))),(0,r.kt)("p",null,"\ub3c4\ucee4 \uc774\ubbf8\uc9c0 \ube4c\ub4dc \ud558\uace0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t \ub3c4\ucee4\uc720\uc800\uc774\ub984/\ub3c4\ucee4\uc800\uc7a5\uc18c\uc774\ub984:\ub3c4\ucee4\ud0dc\uadf8 .\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\ub3c4\ucee4 \ud5c8\ube0c push"))),(0,r.kt)("p",null,"\ub85c\uadf8\uc778\ud558\uace0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker login -u \ub3c4\ucee4\uacc4\uc815\uba85\n")),(0,r.kt)("p",null,"push"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker push \ub3c4\ucee4\uc800\uc7a5\uc18c:\ud0dc\uadf8\n")),(0,r.kt)("p",null,"\ub3c4\ucee4\uc800\uc7a5\uc18c:\ud0dc\uadf8\ub294 \uc774\ubbf8\uc9c0\ub97c \ud2b9\uc815\ud558\ub294 \uac70\ub2e4."),(0,r.kt)("h2",{id:"github-action-\uc124\uc815"},"github action \uc124\uc815"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"yaml\ud30c\uc77c \uc791\uc131\ud558\uba74 \ub05d."))}c.isMDXComponent=!0}}]);